import numpy as np
import pytest

import colorio


@pytest.mark.parametrize(
    "xyz1,ref",
    [
        # Reference values from
        # https://github.com/konovalenko-iitp/proLab/issues/1
        ([0, 0, 0], [0, 0, 0]),
        (
            [0.4125, 0.2127, 0.0193],
            [63.8840288724046, 64.6990640516586, 26.6669016620194],
        ),
        (
            [0.3576, 0.7152, 0.1192],
            [93.2716571815066, -46.2800903959253, 30.9424868459988],
        ),
        (
            [0.1804, 0.0722, 0.9503],
            [67.8231981080096, 19.0112542939369, -65.5738972992030],
        ),
        (
            [0.5380, 0.7873, 1.0695],
            [96.5221783934792, -23.0577449276171, -9.5036807889233],
        ),
        (
            [0.5929, 0.2848, 0.9696],
            [82.3971530943598, 48.2198738004278, -32.2340753634712],
        ),
        (
            [0.7700, 0.9278, 0.1385],
            [98.6660005066217, -10.1366890587630, 34.9355957675890],
        ),
        (
            [0.9505, 1.0000, 1.0888],
            [100.0000000000022, 0.0027564564733, 0.0011278893172],
        ),
    ],
)
def test_reference_xyz(xyz1, ref):
    xyz100 = np.array(xyz1) * 100
    cs = colorio.cs.PROLAB()
    xyz100 = np.asarray(xyz100)
    val = cs.from_xyz100(xyz100)
    print(ref)
    print(val)
    assert np.all(np.abs(val - ref) < 1.0e-4 * np.abs(ref) + 1.0e-4)
